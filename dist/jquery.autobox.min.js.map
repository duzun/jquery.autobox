{"version":3,"file":"jquery.autobox.min.js","sources":["jquery.autobox.js"],"sourcesContent":["/**\n * Autogrow Textareas\n * jQuery.autobox\n *\n * https://github.com/duzun/jquery.autobox\n *\n * Copyright (c) 2018 Dumitru Uzun\n *\n *  @license The MIT license.\n *  @version 3.0.1\n *  @author DUzun.Me\n */\n\n/**\n *\n * Usage:\n *\n * $().\n *    autobox()        - Adjust Height/Width of all TEXTAREAs in this and it's descendants\n *    autoboxOn(sel)   - Bind Auto Height/Width Adjustment events to matched element, listening on sel elements\n *    autoboxBind()    - Bind Auto Height/Width Adjustment events to all TEXTAREAs in this and it's descendants\n */\n\n/*jshint\n    esversion: 6,\n    browser: true\n*/\n\nconst TEXTAREA = 'TEXTAREA';\nconst autoboxedClass = 'autoboxed';\nconst namespace = '.dynSiz';\n\nconst _events = [\n        'autobox'\n      , 'keypress'\n      , 'keyup'\n      , 'click'\n      , 'change'\n      , 'focusin'\n      , 'cut'\n      , 'paste'\n    ]\n;\n\n// Constants for internal use\nconst RESIZE_VERTICAL_FLAG   = 1;\nconst RESIZE_HORIZONTAL_FLAG = 2;\n\nconst ROWS_POS       = 0;\nconst COLS_POS       = 1;\nconst HEIGHT_POS     = 2;\nconst WIDTH_POS      = 3;\nconst OVERFLOW_Y_POS = 4;\nconst OVERFLOW_X_POS = 5;\nconst RESIZE_POS     = 6;\n\nexport default function init($) {\n    var cchChkElement;\n    var cchChkWidth;\n    var cchChkHeight;\n\n    function taMH(h,i) {\n        if ( !h || ( (i=parseInt(h, 10)) && i < 18 ) ) {\n            h = '18px';\n        }\n        return h;\n    }\n\n    function findTEXTAREA(ctx) {\n        return ctx.filter(TEXTAREA).add(ctx.find(TEXTAREA));\n    }\n\n    function chkSize(s, save) {\n        var t = $(s)\n        ,   w = t.outerWidth()\n        ,   h = t.outerHeight()\n        ;\n        s = t.get(0);\n        if ( save ) {\n            if ( cchChkElement && cchChkElement !== s ) {\n                chkSize(cchChkElement);\n            }\n            cchChkWidth   = w;\n            cchChkHeight  = h;\n            cchChkElement = s;\n        }\n        else {\n            if ( cchChkElement === s ) {\n                if ( cchChkHeight != h || cchChkWidth != w ) {\n                    t.trigger('resize');\n                    cchChkWidth  = w;\n                    cchChkHeight = h;\n                    return true;\n                }\n            }\n        }\n    }\n\n    function taBoxAdj() {\n        var t  = this\n        ,   o  = $(t)\n        ,   d  = o.data()\n        ,   e  = d._ab_origs\n        ,   s  = t.style\n        ,   ol = o.val()\n        ,   v  = ol.split('\\n')\n        ,   ar = o.prop('rows')\n        ,   ac = o.prop('cols')\n        ,   c  = 0\n        ,   r, i, l\n        ;\n\n        chkSize(o, true);\n\n        for ( i=0,r=v.length; i<r; i++ ) {\n            if ( (l=v[i].length) > c ) {\n                c = l;\n            }\n        }\n\n        // On first call, backup original metric properties\n        if ( !e ) {\n            // Can't init when hidden - all metrics are zero\n            if ( o.is(':hidden') ) {\n                return;\n            }\n            o.stop(true);\n            e = d._ab_origs = [\n                ar\n              , ac\n              , s.height || o.css('height')\n              , s.width  || o.css('width')\n              , o.css('overflow-y')\n              , o.css('overflow-x')\n              , o.css('resize')\n            ];\n            e.aw = o.attr('width');\n            e.ah = o.attr('height');\n            i = 0;\n            if(!e.ah) { i |= RESIZE_VERTICAL_FLAG;   }\n            if(!e.aw) { i |= RESIZE_HORIZONTAL_FLAG; }\n\n            // use ar\n            if( i === 0 || i === (RESIZE_VERTICAL_FLAG | RESIZE_HORIZONTAL_FLAG) ) {\n                switch(o.prop('resize') || o.attr('resize') || e[RESIZE_POS]) {\n                    case 'vertical':   i = RESIZE_VERTICAL_FLAG  ; break;\n                    case 'horizontal': i = RESIZE_HORIZONTAL_FLAG; break;\n                }\n            }\n            if ( e.ar = i ) {\n                var css = { resize: 'none' };\n                if(i === RESIZE_VERTICAL_FLAG  ) {\n                    css['overflow-y'] = 'hidden';\n                    !e.aw && (e.aw = e[WIDTH_POS]);\n                    delete e.ah;\n                }\n                if(i === RESIZE_HORIZONTAL_FLAG) {\n                    css['overflow-x'] = 'hidden';\n                    !e.ah && (e.ah = e[HEIGHT_POS]);\n                    delete e.aw;\n                }\n                o.css(css);\n            }\n            // Ensure data is saved\n            o.data('_ab_origs', e);\n        }\n\n        // Not first call\n        else {\n            e = d._ab_origs;\n            delete e.rest;\n        }\n\n        ol = ol.length;\n        v = e.ah || 'auto';\n        l = e.aw || 'auto';\n        e.nadj = ~e.ar & RESIZE_VERTICAL_FLAG;\n\n        if(!c) {\n            if(r <= 1) {\n                r = e[ROWS_POS];\n                v = e[HEIGHT_POS];\n                e.nadj = true;\n            }\n            else {\n                r++;\n            }\n            c = e[COLS_POS];\n            l = e[WIDTH_POS];\n            (e.ar & RESIZE_VERTICAL_FLAG) && o.prop('rows', r);\n        }\n        else {\n            c += 5 + (c>>4);\n            r += ar > 2 || r > 1;\n            (r > ar || ol < e.tl && (e.ar & RESIZE_VERTICAL_FLAG)) && o.prop('rows', r);\n        }\n        (e.ar & RESIZE_HORIZONTAL_FLAG) && o.prop('cols', c).prop('size', c);\n        o.css({'height':taMH(v),'width':l});\n        e.tl = ol;\n\n        function adjRows() {\n            if(!o.data('_ab_origs')) return;\n            ar = t.rows;\n            var s = t.scrollHeight\n            ,   h = t.offsetHeight\n            ,   d = 0\n            ,   a = s - h\n            ,   ih = h\n            ,   ir = ar\n            ;\n            for(;d != a && s && h;) {\n                // if(d == a || !s || !h) break;\n                d = a;\n                if(a > 0) {\n                    o.prop('rows', Math.max(++ar, (s*ar/h>>0)-1, r));\n                    s = t.scrollHeight;\n                    h = t.offsetHeight;\n                    a = s - h;\n                    // If rows changed but height not, seems there is some limitation on height (ex max-height)\n                    if(ir != t.rows && ih == h) {\n                        o.css('overflow-y', '');\n                        o.prop('rows', ir);\n                        break;\n                    }\n                }\n            }\n            // if need to adjust height and it changed, try to change it after a delay\n            if(a > 5 && ih != h) setTimeout(adjRows, 16);\n\n            chkSize(o);\n        }\n\n        e.nadj ? chkSize(o) : adjRows();\n    }\n\n    function taRestoreBox(e) {\n        var o = $(this)\n        ,   d = e.data\n        ;\n        if(e=o.data('_ab_origs')) {\n            e.rest = true;\n            setTimeout(function () {\n                if(!e.rest) return;\n                chkSize(o, true);\n                o.removeData('_ab_origs')\n                 .prop('rows', e[ROWS_POS]) // for textarea\n                 .prop('cols', e[COLS_POS]) // for textarea\n                 .prop('size', e[COLS_POS]) // for input\n                 .css({\n                    'overflow-y': e[OVERFLOW_Y_POS]\n                  , 'overflow-x': e[OVERFLOW_X_POS]\n                  , 'resize'    : e[RESIZE_POS]\n                });\n                e = {\n                    'height': taMH(e[HEIGHT_POS])\n                  , 'width' : e[WIDTH_POS]\n                };\n\n                if(d.speed) {\n                    o.animate(e, d.speed, function () {\n                        chkSize(o);\n                    });\n                }\n                else {\n                    chkSize(o.css(e));\n                }\n            }, d.delay||250); // bigger delay to allow for clicks on element beneath textarea\n        }\n    }\n\n    function autoBox() {\n        var o = findTEXTAREA(this) ;\n        o.each(taBoxAdj);\n        return this;\n    }\n\n    function autoboxBind(s) {\n        var o = findTEXTAREA(this) ;\n        s = $.extend({}, $.autobox.options, s);\n        o\n         .addClass(autoboxedClass)\n         .off(namespace);\n        $.each(_events, function (i,e) {\n            o.on(e+namespace, taBoxAdj);\n        });\n        if ( !s.permanent ) {\n            o.on('blur'+namespace, s, taRestoreBox);\n        }\n        return this;\n    }\n\n    function autoBoxOn(sel, s) {\n        var o = this;\n        s = $.extend({}, $.autobox.options, s);\n        sel || (sel = TEXTAREA);\n        o.off(namespace, sel)\n         .addClass(autoboxedClass)\n         .on(\n            _events.join(namespace+' ')+namespace\n            , sel\n            , taBoxAdj\n          )\n        ;\n\n        if ( !s.permanent ) {\n            o.on('blur'+namespace+' '+'focusout'+namespace, sel, s, taRestoreBox) ;\n        }\n\n        return o;\n    }\n\n// Export:\n\n    // Collection methods.\n    $.fn.autobox     = autoBox     ;\n    $.fn.autoboxOn   = autoBoxOn   ;\n    $.fn.autoboxBind = autoboxBind ;\n\n    // Alias\n    $.fn.bindAutobox = autoboxBind ;\n\n    // Static method.\n    $.autobox = function(elements, options) {\n      // Override default options with passed-in options.\n      options = $.extend({}, $.autobox.options, options);\n      // Return something awesome.\n      return $(elements).call(autoBox);\n    };\n\n    // Static method default options.\n    $.autobox.options = {\n      permanent: false\n    };\n\n    // Custom selector.\n    $.expr[':'].autobox = function(elem) {\n      // Is this element awesome?\n      return $(elem).hasClass(autoboxedClass);\n    };\n}\n\nif ( typeof window !== 'undefined' ) {\n    const $ = window.jQuery || window.Zepto;\n    if ( $ ) init($);\n}\n"],"names":["TEXTAREA","autoboxedClass","namespace","_events","RESIZE_VERTICAL_FLAG","RESIZE_HORIZONTAL_FLAG","ROWS_POS","COLS_POS","HEIGHT_POS","WIDTH_POS","OVERFLOW_Y_POS","OVERFLOW_X_POS","RESIZE_POS","init","$","cchChkElement","cchChkWidth","cchChkHeight","taMH","h","i","parseInt","findTEXTAREA","ctx","filter","add","find","chkSize","s","save","t","w","outerWidth","outerHeight","get","trigger","taBoxAdj","r","l","this","o","d","data","e","_ab_origs","style","ol","val","v","split","ar","prop","ac","c","length","rest","is","stop","height","css","width","aw","attr","ah","resize","nadj","tl","adjRows","rows","scrollHeight","offsetHeight","a","ih","ir","Math","max","setTimeout","taRestoreBox","removeData","speed","animate","delay","autoBox","each","autoboxBind","extend","autobox","options","addClass","off","on","permanent","fn","autoboxOn","sel","join","bindAutobox","elements","call","expr","elem","hasClass","window","jQuery","Zepto"],"mappings":"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"}