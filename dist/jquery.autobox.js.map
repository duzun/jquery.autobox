{"version":3,"file":"jquery.autobox.js","sources":["src/jquery.autobox.js"],"sourcesContent":["/**\n * Autogrow Textareas\n * jQuery.autobox\n *\n * https://github.com/duzun/jquery.autobox\n *\n * Copyright (c) 2021 Dumitru Uzun\n *\n *  @license The MIT license.\n *  @version 3.1.0\n *  @author DUzun.Me\n */\n\n/**\n *\n * Usage:\n *\n * $().\n *    autobox(options)        - Adjust Height/Width of all TEXTAREAs in this and it's descendants\n *    autoboxOn(sel, options) - Bind Auto Height/Width Adjustment events to matched element, listening on sel elements\n *    autoboxBind(options)    - Bind Auto Height/Width Adjustment events to all TEXTAREAs in this and it's descendants\n *\n * $.autobox(elements, options) - same as $(elements).autobox(options)\n *\n * Options:\n *  permanent: bool - if false, the textarea would restore its size on blur\n *  resize: \"vertical\" | \"horizontal\" | <empty> - resize mode, leave empty for autodetection\n *  speed: number - restore height animation speed (default 0 - no animation)\n *  delay: number - delay before restoring textarea height on blur (default 250 milliseconds)\n *\n */\n\n/*jshint\n    esversion: 9,\n    browser: true\n*/\n\nconst TEXTAREA = 'TEXTAREA';\nconst AUTOBOXED_CLASS = 'autoboxed';\nconst NAMESPACE = '.dynSiz';\n\nconst _events = [\n        'autobox'\n      , 'keypress'\n      , 'keyup'\n      , 'click'\n      , 'change'\n      , 'focusin'\n      , 'cut'\n      , 'paste'\n    ]\n;\n\n// Constants for internal use\nconst RESIZE_VERTICAL_FLAG   = 1;\nconst RESIZE_HORIZONTAL_FLAG = 2;\n\nconst ROWS_POS       = 0;\nconst COLS_POS       = 1;\nconst HEIGHT_POS     = 2;\nconst WIDTH_POS      = 3;\nconst OVERFLOW_Y_POS = 4;\nconst OVERFLOW_X_POS = 5;\nconst RESIZE_POS     = 6;\n\nexport default function initJQAutobox($) {\n    var cchChkElement;\n    var cchChkWidth;\n    var cchChkHeight;\n\n    function taMH(h,i) {\n        if ( !h || ( (i=parseInt(h, 10)) && i < 18 ) ) {\n            h = '18px';\n        }\n        return h;\n    }\n\n    function findTEXTAREA(ctx) {\n        return ctx.filter(TEXTAREA).add(ctx.find(TEXTAREA));\n    }\n\n    function chkSize(s, save) {\n        var t = $(s)\n        ,   w = t.outerWidth()\n        ,   h = t.outerHeight()\n        ;\n        s = t.get(0);\n        if ( save ) {\n            if ( cchChkElement && cchChkElement !== s ) {\n                chkSize(cchChkElement);\n            }\n            cchChkWidth   = w;\n            cchChkHeight  = h;\n            cchChkElement = s;\n        }\n        else {\n            if ( cchChkElement === s ) {\n                if ( cchChkHeight != h || cchChkWidth != w ) {\n                    t.trigger('resize');\n                    cchChkWidth  = w;\n                    cchChkHeight = h;\n                    return true;\n                }\n            }\n        }\n    }\n\n    function taBoxAdj(evt) {\n        var that  = this\n        ,   $ta  = $(that)\n        ,   data  = $ta.data()\n        ,   e  = data._ab_origs\n        ,   style  = that.style\n        ,   ol = $ta.val()\n        ,   v  = ol.split('\\n')\n        ,   ar = $ta.prop('rows')\n        ,   ac = $ta.prop('cols')\n        ,   c  = 0\n        ,   r, i, l\n        ,   options = evt && evt.type && evt.data\n        ;\n\n        chkSize($ta, true);\n\n        for ( i=0,r=v.length; i<r; i++ ) {\n            if ( (l=v[i].length) > c ) {\n                c = l;\n            }\n        }\n\n        // On first call, backup original metric properties\n        if ( !e ) {\n            // Can't init when hidden - all metrics are zero\n            if ( $ta.is(':hidden') ) {\n                return;\n            }\n            $ta.stop(true);\n            e = data._ab_origs = [\n                ar\n              , ac\n              , style.height || $ta.css('height')\n              , style.width  || $ta.css('width')\n              , $ta.css('overflow-y')\n              , $ta.css('overflow-x')\n              , $ta.css('resize')\n            ];\n            e.aw = $ta.attr('width');\n            e.ah = $ta.attr('height');\n            i = 0;\n            if(!e.ah) { i |= RESIZE_VERTICAL_FLAG;   }\n            if(!e.aw) { i |= RESIZE_HORIZONTAL_FLAG; }\n\n            // use ar\n            if( i === 0 || i === (RESIZE_VERTICAL_FLAG | RESIZE_HORIZONTAL_FLAG) ) {\n                // resize option overrides CSS and DOM property\n                switch(options && options.resize || $ta.prop('resize') || $ta.attr('resize') || e[RESIZE_POS]) {\n                    case 'vertical':   i = RESIZE_VERTICAL_FLAG  ; break;\n                    case 'horizontal': i = RESIZE_HORIZONTAL_FLAG; break;\n                }\n            }\n            if ( e.ar = i ) {\n                var css = { resize: 'none' };\n                if(i === RESIZE_VERTICAL_FLAG  ) {\n                    css['overflow-y'] = 'hidden';\n                    !e.aw && (e.aw = e[WIDTH_POS]);\n                    delete e.ah;\n                }\n                if(i === RESIZE_HORIZONTAL_FLAG) {\n                    css['overflow-x'] = 'hidden';\n                    !e.ah && (e.ah = e[HEIGHT_POS]);\n                    delete e.aw;\n                }\n                $ta.css(css);\n            }\n            // Ensure data is saved\n            $ta.data('_ab_origs', e);\n        }\n\n        // Not first call\n        else {\n            e = data._ab_origs;\n            delete e.rest;\n        }\n\n        ol = ol.length;\n        v = e.ah || 'auto';\n        l = e.aw || 'auto';\n        e.nadj = ~e.ar & RESIZE_VERTICAL_FLAG;\n\n        if(!c) {\n            if(r <= 1) {\n                r = e[ROWS_POS];\n                v = e[HEIGHT_POS];\n                e.nadj = true;\n            }\n            else {\n                r++;\n            }\n            c = e[COLS_POS];\n            l = e[WIDTH_POS];\n            (e.ar & RESIZE_VERTICAL_FLAG) && $ta.prop('rows', r);\n        }\n        else {\n            c += 5 + (c>>4);\n            r += ar > 2 || r > 1;\n            (r > ar || ol < e.tl && (e.ar & RESIZE_VERTICAL_FLAG)) && $ta.prop('rows', r);\n        }\n        (e.ar & RESIZE_HORIZONTAL_FLAG) && $ta.prop('cols', c).prop('size', c);\n        $ta.css({'height':taMH(v),'width':l});\n        e.tl = ol;\n\n        function adjRows() {\n            if(!$ta.data('_ab_origs')) return;\n            ar = that.rows;\n            var s = that.scrollHeight\n            ,   h = that.offsetHeight\n            ,   d = 0\n            ,   a = s - h\n            ,   ih = h\n            ,   ir = ar\n            ;\n            for(;d != a && s && h;) {\n                // if(d == a || !s || !h) break;\n                d = a;\n                if(a > 0) {\n                    $ta.prop('rows', Math.max(++ar, (s*ar/h>>0)-1, r));\n                    s = that.scrollHeight;\n                    h = that.offsetHeight;\n                    a = s - h;\n                    // If rows changed but height not, seems there is some limitation on height (ex max-height)\n                    if(ir != that.rows && ih == h) {\n                        $ta.css('overflow-y', '');\n                        $ta.prop('rows', ir);\n                        break;\n                    }\n                }\n            }\n            // if need to adjust height and it changed, try to change it after a delay\n            if(a > 5 && ih != h) setTimeout(adjRows, 16);\n\n            chkSize($ta);\n        }\n\n        e.nadj ? chkSize($ta) : adjRows();\n    }\n\n    function taRestoreBox(e) {\n        var o = $(this)\n        ,   options = e.data\n        ;\n        if(e=o.data('_ab_origs')) {\n            e.rest = true;\n            setTimeout(function () {\n                if(!e.rest) { return; }\n                chkSize(o, true);\n                o.removeData('_ab_origs')\n                 .prop('rows', e[ROWS_POS]) // for textarea\n                 .prop('cols', e[COLS_POS]) // for textarea\n                 .prop('size', e[COLS_POS]) // for input\n                 .css({\n                    'overflow-y': e[OVERFLOW_Y_POS]\n                  , 'overflow-x': e[OVERFLOW_X_POS]\n                  , 'resize'    : e[RESIZE_POS]\n                });\n                e = {\n                    'height': taMH(e[HEIGHT_POS])\n                  , 'width' : e[WIDTH_POS]\n                };\n\n                if(options.speed) {\n                    o.animate(e, options.speed, function () {\n                        chkSize(o);\n                    });\n                }\n                else {\n                    chkSize(o.css(e));\n                }\n            }, options.delay||250); // bigger delay to allow for clicks on element beneath textarea\n        }\n    }\n\n    function autoBox(options) {\n        var o = findTEXTAREA(this) ;\n        if (options) {\n            const evt = { type: 'autobox', data: options };\n            o.each((i, e) => taBoxAdj.call(e, evt));\n        }\n        else {\n            o.each(taBoxAdj);\n        }\n        return this;\n    }\n\n    function autoboxBind(options) {\n        var o = findTEXTAREA(this) ;\n        options = $.extend({}, $.autobox.options, options);\n        o\n         .addClass(AUTOBOXED_CLASS)\n         .off(NAMESPACE);\n        $.each(_events, function (i,e) {\n            o.on(e+NAMESPACE, options, taBoxAdj);\n        });\n        if ( !options.permanent ) {\n            o.on('blur'+NAMESPACE, options, taRestoreBox);\n        }\n        return this;\n    }\n\n    function autoBoxOn(sel, options) {\n        var o = this;\n        options = $.extend({}, $.autobox.options, options);\n        sel || (sel = TEXTAREA);\n        o.off(NAMESPACE, sel)\n         .addClass(AUTOBOXED_CLASS)\n         .on(\n            _events.join(NAMESPACE+' ')+NAMESPACE\n            , sel\n            , options\n            , taBoxAdj\n          )\n        ;\n\n        if ( !options.permanent ) {\n            o.on('blur'+NAMESPACE+' '+'focusout'+NAMESPACE, sel, options, taRestoreBox) ;\n        }\n\n        return o;\n    }\n\n// Export:\n\n    // Collection methods.\n    $.fn.autobox     = autoBox     ;\n    $.fn.autoboxOn   = autoBoxOn   ;\n    $.fn.autoboxBind = autoboxBind ;\n\n    // Alias\n    $.fn.bindAutobox = autoboxBind ;\n\n    // Static method.\n    $.autobox = function(elements, options) {\n      // Override default options with passed-in options.\n      options = $.extend({}, $.autobox.options, options);\n\n      return $(elements).call(autoBox, options);\n    };\n\n    // Static method default options.\n    $.autobox.options = {\n        resize: undefined, // 'vertical' | 'horizontal'\n        permanent: false,\n        speed: 0, // restore height animation speed\n        delay: 250, // delay before restoring textarea height on blur\n    };\n\n    // Custom selector.\n    $.expr[':'].autobox = function(elem) {\n      // Is this element autoboxed?\n      return $(elem).hasClass(AUTOBOXED_CLASS);\n    };\n}\n\nif ( typeof window !== 'undefined' ) {\n    const $ = window.jQuery || window.Zepto;\n    if ( $ ) initJQAutobox($);\n}\n"],"names":["TEXTAREA","AUTOBOXED_CLASS","NAMESPACE","_events","RESIZE_VERTICAL_FLAG","RESIZE_HORIZONTAL_FLAG","ROWS_POS","COLS_POS","HEIGHT_POS","WIDTH_POS","OVERFLOW_Y_POS","OVERFLOW_X_POS","RESIZE_POS","initJQAutobox","$","cchChkElement","cchChkWidth","cchChkHeight","taMH","h","i","parseInt","findTEXTAREA","ctx","filter","add","find","chkSize","s","save","t","w","outerWidth","outerHeight","get","trigger","taBoxAdj","evt","that","$ta","data","e","_ab_origs","style","ol","val","v","split","ar","prop","ac","c","r","l","options","type","length","is","stop","height","css","width","aw","attr","ah","resize","rest","nadj","tl","adjRows","rows","scrollHeight","offsetHeight","d","a","ih","ir","Math","max","setTimeout","taRestoreBox","o","removeData","speed","animate","delay","autoBox","each","call","autoboxBind","extend","autobox","addClass","off","on","permanent","autoBoxOn","sel","join","fn","autoboxOn","bindAutobox","elements","undefined","expr","elem","hasClass","window","jQuery","Zepto"],"mappings":"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"}